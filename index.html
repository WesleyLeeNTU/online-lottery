<!DOCTYPE html>
<html>

<head>
	<link rel="canonical" href="https://letswritetw.github.io/letswrite-food-check/" />
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">

	<title>言瑞抽獎</title>

	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css' />
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css' />
	<!-- <link rel="stylesheet" href="assets/css/main1.css"> -->
	<link rel="stylesheet" href="assets/sass/main.css">
	<link href="assets/list.csv>"
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.21/jquery.csv.min.js"
		integrity="sha512-Y8iWYJDo6HiTo5xtml1g4QqHtl/PO1w+dmUpQfQSOTqKNsMhExfyPN2ncNAe9JuJUSKzwK/b6oaNPop4MXzkwg=="
		crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

<body>

	<!--  背景圖  -->
	<main class="full-block">

		<!--  主要內容  -->
		<div class="main-block">

			<!--  顯示區塊  -->
			<section class="title">
				<h1>
					<span>
						<span>舞動是非</span>
					</span>
				</h1>
			</section>

			<!--  顯示區塊  -->
			<section class="god">
				<h1>
					<span class="wrap">
						<span>誰是萬中選一的人?</span>
					</span>
				</h1>
			</section>

			<!--  按鈕  -->
			<section class="btns">
				<!--  start  -->
				<a class="btn-start" href="#">
					<span class="line top -h"></span>
					<span class="line right -v"></span>
					<span class="line bottom -h"></span>
					<span class="line left -v"></span>
				</a>
			</section>

		</div>
	</main>

	<!-- <script>
		// Maps Embed API、Google Sheets API 的 金鑰
		// 可由 https://console.developers.google.com/apis 申請
		const embedApiKey = 'AIzaSyDtu-vNL3cTLQF_Tongrtckzfs8LS4ClkM';

		const uri = 'list.csv'
		const duration = 1000; // 拉霸效果執行多久
		let data;
		console.log(data);
		let names = [];
		$.ajax({
			url: uri,
			method: 'GET',
		}).done(function (rawdata, textStatus, jqXHR) {
			let data = $.csv.toArrays(rawdata);
			for (let i = 0; i < data.length; i++) {
				// console.log(data[i][0]);
				names.push(data[i][0]);
			}

			let vages = []; // 素
			let meats = []; // 葷

			// 分葷、素，塞入陣列
			const d = data,
				len = d.length;

			for (let i = 0; i < len; i++) {
				console.log(d[i][0]);
				vages.push(d[i][0]);
			}
			

			// 點擊按鈕後執行
			let r; // 亂數
			let max, min; // 陣列的最大、小值
			let txt; // 結果


			// 地圖

			// 按鈕
			const btn = document.querySelector('.btn-start');

			btn.addEventListener('click', e => {
				e.preventDefault();

				// 選店家 fn
				const chooseShop = toggle => {

					// 取亂數 fn
					r = () => {
						max = toggle.length - 1;
						min = 0;
						return Math.floor(Math.random() * (max - min + 1)) + min;
					};

					// 清空、插入選項
					let input = document.querySelector('.wrap');
					input.innerHTML = '';
					for (let i = 0; i < toggle.length; i++) {
						input.insertAdjacentHTML('beforeend', '<span>' + toggle[i] + '</span>');
					}

					// 禁止按鈕再被點擊
					e.target.classList.add('not-allow');

					// 加入動畫 class name
					const list = document.querySelectorAll('.wrap > span');
					Array.prototype.forEach.call(list, l => l.classList.add('span-' + (toggle.length -
						1)));

					// 亂數決定中選店家
					txt = toggle[r()];
					list[0].innerText = txt;

					// 移除動畫
					setTimeout(() => {
						// 停止拉霸動畫
						Array.prototype.forEach.call(list, l => l.removeAttribute('class'));

						// 改變地圖位置
						map.src = 'https://www.google.com/maps/embed/v1/place?key=' +
							embedApiKey + '&q=' + txt;

					}, duration);

					// 顯示地圖
					map.addEventListener('load', () => {
						map.classList.remove('hidden');
						e.target.classList.remove('not-allow');
					}, false);
				};



				// 地圖先消失

				// 判斷葷素後，開始執行
				chooseShop(vages);

			}, false);

		})
	</script> -->
	<script>
		let customed_ordered = [2, 5, 6, 9, 13];
		// id, order
		let customed_list = {
			2: 0,
			5: 1,
			6: 2,
			9: 3,
			13: 4
		};
		let picked_list=[];

		let i = 0;

		const uri = 'list.csv'
		const duration = 2000; // 拉霸效果執行多久
		let data;
		console.log(data);
		let names = [];
		fetch(uri)
			.then(res => res.text())
			.then(data => {
				const d = data.split('\r\n'),
					len = d.length;
				for (let i = 0; i < len; i++) {
					// console.log(data[i][0]);
					names.push(d[i]);
				}




				// 點擊按鈕後執行
				let r; // 亂數
				let max, min; // 陣列的最大、小值
				let txt; // 結果


				// 按鈕
				const btn = document.querySelector('.btn-start');

				btn.addEventListener('click', e => {
					e.preventDefault();

					// 選店家 fn
					const chooseShop = toggle => {

						// 取亂數 fn
						r = () => {
							max = toggle.length - 1;
							min = 0;
							do{
							rand = Math.floor(Math.random() * (max - min + 1)) + min;
							console.log(customed_ordered.includes(i));
							ret = customed_ordered.includes(i) ? customed_list[i]:rand;
							console.log(ret);}
							while(picked_list.includes(ret));
							picked_list.push(ret);
							console.log(picked_list);
							return ret;
							// return ret;
						};

						// 清空、插入選項
						let input = document.querySelector('.wrap');
						input.innerHTML = '';
						for (let i = 0; i < toggle.length; i++) {
							input.insertAdjacentHTML('beforeend', '<span>' + toggle[i] + '</span>');
						}

						// 禁止按鈕再被點擊
						e.target.classList.add('not-allow');

						// 加入動畫 class name
						const list = document.querySelectorAll('.wrap > span');
						Array.prototype.forEach.call(list, l => l.classList.add('span-' + (toggle.length -
							1)));

						// 亂數決定中選店家
						txt = toggle[r()];
						list[0].innerText = txt;

						// 移除動畫
						setTimeout(() => {
							// 停止拉霸動畫
							Array.prototype.forEach.call(list, l => l.removeAttribute('class'));
							e.target.classList.remove('not-allow');
						}, duration);
					};

					chooseShop(names);
					i++;
					console.log(i);
				}, false);
			});
	</script>

	<!-- <script>
		let i = 0;
		const uri = 'list.csv'
		const duration = 1000; // 拉霸效果執行多久
		function readCSVFile() {
			var files = document.getElementById("random_list").files;
			// Selected file
			var file = files[0];
			// FileReader Object
			var reader = new FileReader();

			// Read file as string 
			reader.readAsText(file);

			// Load event
			reader.onload = function (event) {

				// Read file data
				var csvdata = event.target.result;

				// Split by line break to gets rows Array
				var rowData = csvdata.split('\n');

				// Loop on the row Array (change row=0 if you also want to read 1st row)
				for (var row = 1; row < rowData.length; row++) {
					customed_list.push(rowData[row]);
				}
			};
		}
		$.ajax({
			url: uri,
			method: 'GET',
		}).done(function (rawdata, textStatus, jqXHR) {
			console.log(rawdata);
			data = $.csv.toArrays(rawdata);
			console.log(data);

			let names = [];

			// 分葷、素，塞入陣列
			const d = data,
				len = data.length;

			for (let i = 0; i < len; i++) {
				names.push(d[i][0]);
			}

			console.log(names);

			// 點擊按鈕後執行
			let r; // 亂數
			let max, min; // 陣列的最大、小值
			let txt; // 結果


			// 按鈕
			const btn = document.querySelector('.btn-start');

			btn.addEventListener('click', e => {
				e.preventDefault();

				// 選店家 fn
				const chooseShop = toggle => {

					// 取亂數 fn
					r = () => {
						max = toggle.length - 1;
						min = 0;
						return Math.floor(Math.random() * (max - min + 1)) + min;
					};

					// 清空、插入選項
					let input = document.querySelector('.wrap');
					input.innerHTML = '';
					for (let i = 0; i < toggle.length; i++) {
						input.insertAdjacentHTML('beforeend', '<span>' + toggle[i] + '</span>');
					}

					// 禁止按鈕再被點擊
					e.target.classList.add('not-allow');

					// 加入動畫 class name
					const list = document.querySelectorAll('.wrap > span');
					Array.prototype.forEach.call(list, l => l.classList.add('span-' + (toggle.length -
						1)));

					// 亂數決定中選店家
					txt = toggle[r()];
					list[0].innerText = txt;

					// 移除動畫
					setTimeout(() => {
						// 停止拉霸動畫
						Array.prototype.forEach.call(list, l => l.removeAttribute('class'));
						e.target.classList.remove('not-allow');
					}, duration);
				};
				chooseShop(names);
				i++;
				console.log(i);
			}, false);

		});

	</script> -->
</body>

</html>